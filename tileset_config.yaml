# Tileset Configuration
# Defines all tilesets with their viewing ranges and feature inclusion rules
# Uses YAML anchors (&) and aliases (*) to deduplicate feature definitions

# =============================================================================
# GLOBAL SIMPLIFICATION SETTINGS
# =============================================================================
simplification_settings:
  preserve_topology: true
  snap_to_grid: false
  snap_grid_divisor: 2

# =============================================================================
# FEATURE TEMPLATES
# Reusable feature definitions referenced by tilesets via YAML anchors
# =============================================================================
feature_templates:
  # --- Water ---
  coastline: &coastline
    name: "coastline"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        natural: ["coastline"]
    render:
      layer: "coastline"
      color: [255, 0, 255, 255]
      stroke_width_px: 3
      show_direction: true

  water_bodies_all: &water_bodies_all
    name: "water_bodies_all"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        natural: ["water"]
        waterway: ["riverbank"]
        landuse: ["basin", "reservoir", "salt_pond"]
    render:
      layer: "water"
      color: [170, 211, 223, 255]
      fill: true

  major_rivers: &major_rivers
    name: "major_rivers"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        waterway: ["river", "canal"]
    render:
      layer: "waterways"
      color: [170, 211, 223, 255]

  minor_waterways: &minor_waterways
    name: "minor_waterways"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        waterway: ["stream", "ditch", "drain"]
    render:
      layer: "waterways"
      color: [170, 211, 223, 255]

  # --- Natural areas ---
  scrub_heath: &scrub_heath
    name: "scrub_heath"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        natural: ["scrub", "heath"]
    render:
      layer: "natural_background"
      color: [200, 215, 175, 255]
      fill: true

  wetland: &wetland
    name: "wetland"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        natural: ["wetland"]
    render:
      layer: "natural_background"
      color: [200, 225, 210, 255]
      fill: true

  cliff: &cliff
    name: "cliff"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        natural: ["cliff"]
    render:
      layer: "natural_background"
      color: [140, 120, 100, 255]
      stroke_width_px: 2

  beach: &beach
    name: "beach"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        natural: ["beach"]
    render:
      layer: "natural_background"
      color: [255, 241, 186, 255]
      fill: true

  forests_all: &forests_all
    name: "forests_all"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["forest"]
        natural: ["wood"]
      preserve_tags: ["leaf_type"]
    render:
      layer: "forests"
      color: [173, 209, 158, 255]
      fill: true

  # --- Roads ---
  motorways: &motorways
    name: "motorways"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        highway: ["motorway", "trunk", "motorway_link", "trunk_link"]
        construction: ["motorway", "trunk", "motorway_link", "trunk_link"]
        planned: ["motorway", "trunk", "motorway_link", "trunk_link"]
        proposed: ["motorway", "trunk", "motorway_link", "trunk_link"]
      preserve_tags: ["bicycle_road", "cyclestreet", "planned", "proposed"]
    render:
      layer: "major_roads"
      color: [233, 115, 103, 255]
      show_name: true
      name_priority: 1

  primary_roads: &primary_roads
    name: "primary_roads"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        highway: ["primary", "primary_link"]
        construction: ["primary", "primary_link"]
        planned: ["primary", "primary_link"]
        proposed: ["primary", "primary_link"]
      preserve_tags: ["bicycle_road", "cyclestreet", "planned", "proposed"]
    render:
      layer: "major_roads"
      color: [252, 214, 164, 255]
      show_name: true
      name_priority: 2

  secondary_roads: &secondary_roads
    name: "secondary_roads"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        highway: ["secondary", "secondary_link"]
        construction: ["secondary", "secondary_link"]
        planned: ["secondary", "secondary_link"]
        proposed: ["secondary", "secondary_link"]
      preserve_tags: ["bicycle_road", "cyclestreet", "planned", "proposed"]
    render:
      layer: "major_roads"
      color: [252, 214, 164, 255]
      show_name: true
      name_priority: 3

  tertiary_roads: &tertiary_roads
    name: "tertiary_roads"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        highway: ["tertiary", "tertiary_link"]
        construction: ["tertiary", "tertiary_link"]
        planned: ["tertiary", "tertiary_link"]
        proposed: ["tertiary", "tertiary_link"]
      preserve_tags: ["bicycle_road", "cyclestreet", "planned", "proposed"]
    render:
      layer: "roads"
      color: [255, 255, 255, 255]
      show_name: true
      name_priority: 4

  residential_roads: &residential_roads
    name: "residential_roads"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        highway: ["residential", "unclassified", "living_street"]
        construction: ["residential", "living_street"]
        planned: ["residential", "living_street"]
        proposed: ["residential", "living_street"]
      preserve_tags: ["bicycle_road", "cyclestreet", "planned", "proposed"]
    render:
      layer: "roads"
      color: [255, 255, 255, 255]
      show_name: true
      name_priority: 5

  minor_roads: &minor_roads
    name: "minor_roads"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        highway: ["service", "track", "path", "footway", "cycleway", "bridleway",
                  "pedestrian", "steps", "living_street", "corridor", "busway", "raceway"]
        construction: ["service", "track", "path", "footway", "cycleway", "bridleway",
                       "pedestrian", "steps", "living_street", "corridor", "busway", "raceway"]
        planned: ["service", "track", "path", "footway", "cycleway", "bridleway",
                  "pedestrian", "steps", "living_street", "corridor", "busway", "raceway"]
        proposed: ["service", "track", "path", "footway", "cycleway", "bridleway",
                   "pedestrian", "steps", "living_street", "corridor", "busway", "raceway"]
      preserve_tags: ["bicycle_road", "cyclestreet", "planned", "proposed"]
    render:
      layer: "roads"
      color: [220, 220, 220, 255]
      show_name: true
      name_priority: 6

  # --- Railways ---
  major_rail: &major_rail
    name: "major_rail"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        railway: ["rail", "narrow_gauge", "preserved", "construction", "planned", "proposed"]
    render:
      layer: "railways"
      color: [153, 153, 153, 255]
      stroke_width_px: 2
      preserve_tags: ["construction", "planned", "proposed", "railway"]

  subway_light_rail: &subway_light_rail
    name: "subway_light_rail"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        railway: ["subway", "light_rail"]
    render:
      layer: "railways"
      color: [153, 153, 153, 255]
      stroke_width_px: 2

  tram: &tram
    name: "tram"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        railway: ["tram", "funicular", "miniature"]
    render:
      layer: "railways"
      color: [153, 153, 153, 255]
      stroke_width_px: 1

  railway_platforms: &railway_platforms
    name: "railway_platforms"
    osm_match:
      geometry: ["Polygon", "MultiPolygon", "LineString", "MultiLineString"]
      tags:
        railway: ["platform"]
        public_transport: ["platform"]
    render:
      layer: "railways"
      color: [120, 120, 120, 255]
      preserve_tags: ["name", "ref", "railway", "public_transport"]

  railway_stations: &railway_stations
    name: "railway_stations"
    osm_match:
      geometry: ["Point", "Polygon", "MultiPolygon"]
      tags:
        railway: ["station", "halt"]
        public_transport: ["station"]
    render:
      layer: "railways"
      color: [100, 100, 100, 255]
      preserve_tags: ["name", "station", "network", "operator", "railway", "public_transport"]

  # --- Landuse ---
  parks: &parks
    name: "parks"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        leisure: ["park", "garden", "recreation_ground", "dog_park", "playground"]
        landuse: ["grass", "meadow", "village_green", "recreation_ground"]
    render:
      layer: "landuse"
      color: [200, 230, 180, 255]
      fill: true

  agriculture: &agriculture
    name: "agriculture"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["farmland", "farmyard", "orchard", "vineyard",
                  "plant_nursery", "greenhouse_horticulture"]
    render:
      layer: "landuse"
      color: [238, 240, 213, 255]
      fill: true

  residential_landuse: &residential_landuse
    name: "residential_landuse"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["residential"]
    render:
      layer: "landuse"
      color: [224, 224, 224, 255]
      fill: true

  commercial_landuse: &commercial_landuse
    name: "commercial_landuse"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["commercial", "retail"]
    render:
      layer: "landuse"
      color: [243, 233, 234, 255]
      fill: true

  industrial_landuse: &industrial_landuse
    name: "industrial_landuse"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["industrial"]
    render:
      layer: "landuse"
      color: [240, 233, 240, 255]
      fill: true

  cemeteries: &cemeteries
    name: "cemeteries"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["cemetery"]
        amenity: ["grave_yard"]
    render:
      layer: "landuse"
      color: [205, 220, 200, 255]
      fill: true

  military: &military
    name: "military"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["military"]
        military: ["*"]
    render:
      layer: "landuse"
      color: [235, 215, 215, 255]
      fill: true

  railway_yards: &railway_yards
    name: "railway_yards"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["railway"]
    render:
      layer: "landuse"
      color: [210, 205, 210, 255]
      fill: true

  allotments: &allotments
    name: "allotments"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["allotments"]
    render:
      layer: "landuse"
      color: [220, 235, 210, 255]
      fill: true

  construction: &construction
    name: "construction"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["construction", "brownfield", "greenfield"]
    render:
      layer: "landuse"
      color: [235, 220, 200, 255]
      fill: true

  education: &education
    name: "education"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["education"]
        amenity: ["school", "university", "college", "kindergarten"]
    render:
      layer: "landuse"
      color: [245, 235, 210, 255]
      fill: true

  religious: &religious
    name: "religious"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["religious"]
        amenity: ["place_of_worship"]
    render:
      layer: "landuse"
      color: [225, 220, 230, 255]
      fill: true

  quarries: &quarries
    name: "quarries"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["quarry", "landfill"]
    render:
      layer: "landuse"
      color: [210, 200, 190, 255]
      fill: true

  port: &port
    name: "port"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["port"]
    render:
      layer: "landuse"
      color: [200, 210, 220, 255]
      fill: true

  institutional: &institutional
    name: "institutional"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["institutional"]
    render:
      layer: "landuse"
      color: [230, 225, 230, 255]
      fill: true

  flowerbed: &flowerbed
    name: "flowerbed"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        landuse: ["flowerbed"]
    render:
      layer: "landuse"
      color: [210, 230, 190, 255]
      fill: true

  highway_service_areas: &highway_service_areas
    name: "highway_service_areas"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        highway: ["services", "rest_area"]
    render:
      layer: "landuse"
      color: [230, 230, 225, 255]
      fill: true

  # --- Recreation ---
  playground: &playground
    name: "playground"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        leisure: ["playground"]
    render:
      layer: "recreation"
      color: [200, 230, 180, 255]
      fill: true

  swimming_pool: &swimming_pool
    name: "swimming_pool"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        leisure: ["swimming_pool"]
        amenity: ["swimming_pool"]
    render:
      layer: "recreation"
      color: [170, 211, 223, 255]
      fill: true

  picnic_site: &picnic_site
    name: "picnic_site"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        leisure: ["picnic_table"]
        tourism: ["picnic_site"]
    render:
      layer: "recreation"
      color: [200, 230, 180, 255]
      fill: true

  table_tennis: &table_tennis
    name: "table_tennis"
    osm_match:
      geometry: ["Point"]
      match_all: true
      tags:
        leisure: ["pitch"]
        sport: ["table_tennis"]
      preserve_tags: ["sport"]
    render:
      layer: "points"
      color: [100, 160, 100, 255]

  beach_volleyball: &beach_volleyball
    name: "beach_volleyball"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      match_all: true
      tags:
        leisure: ["pitch"]
        sport: ["beachvolleyball"]
    render:
      layer: "recreation"
      color: [255, 241, 186, 255]
      fill: true

  # --- Aeroways ---
  runways: &runways
    name: "runways"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        aeroway: ["runway"]
    render:
      layer: "aeroways"
      color: [80, 80, 80, 255]
      preserve_tags: ["ref", "surface", "width", "lit", "length"]

  taxiways: &taxiways
    name: "taxiways"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        aeroway: ["taxiway"]
    render:
      layer: "aeroways"
      color: [120, 120, 120, 255]
      preserve_tags: ["ref", "surface"]

  aprons: &aprons
    name: "aprons"
    osm_match:
      geometry: ["Polygon", "MultiPolygon", "LineString", "MultiLineString"]
      tags:
        aeroway: ["apron"]
    render:
      layer: "aeroways"
      color: [160, 160, 160, 255]
      fill: true

  helipads: &helipads
    name: "helipads"
    osm_match:
      geometry: ["Polygon", "MultiPolygon", "Point"]
      tags:
        aeroway: ["helipad"]
    render:
      layer: "aeroways"
      color: [100, 100, 100, 255]
      fill: true
      preserve_tags: ["ref"]

  # --- Buildings ---
  buildings: &buildings
    name: "buildings"
    osm_match:
      geometry: ["Polygon", "MultiPolygon"]
      tags:
        building: ["*"]
      tags_exclude:
        building: ["no"]
    render:
      layer: "buildings"
      color: [218, 208, 200, 255]
      fill: true

  # --- Boundaries ---
  country_borders: &country_borders
    name: "country_borders"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      match_all: true
      tags:
        boundary: ["administrative"]
        admin_level: ["2"]
      tags_exclude:
        maritime: ["yes"]
    render:
      layer: "boundaries"
      color: [128, 128, 128, 255]
      stroke_width_px: 2
      dash_pattern: [5, 5]

  state_borders: &state_borders
    name: "state_borders"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      match_all: true
      tags:
        boundary: ["administrative"]
        admin_level: ["4"]
      tags_exclude:
        maritime: ["yes"]
    render:
      layer: "boundaries"
      color: [160, 160, 160, 255]
      stroke_width_px: 1.5
      dash_pattern: [4, 4]

  district_borders: &district_borders
    name: "district_borders"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      match_all: true
      tags:
        boundary: ["administrative"]
        admin_level: ["6"]
      tags_exclude:
        maritime: ["yes"]
    render:
      layer: "boundaries"
      color: [180, 180, 180, 255]
      stroke_width_px: 1
      dash_pattern: [3, 3]

  # Territorial waters (boundary=administrative + maritime=yes)
  maritime_territorial: &maritime_territorial
    name: "maritime_territorial"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      match_all: true
      tags:
        boundary: ["administrative"]
        maritime: ["yes"]
    render:
      layer: "boundaries"
      color: [100, 140, 180, 150]
      stroke_width_px: 1.5
      dash_pattern: [6, 6]

  # Exclusive economic zones (boundary=maritime)
  maritime_eez: &maritime_eez
    name: "maritime_eez"
    osm_match:
      geometry: ["LineString", "MultiLineString"]
      tags:
        boundary: ["maritime"]
    render:
      layer: "boundaries"
      color: [100, 140, 180, 120]
      stroke_width_px: 1
      dash_pattern: [8, 8]

  # --- Labels ---
  cities: &cities
    name: "cities"
    osm_match:
      geometry: ["Point"]
      tags:
        place: ["city"]
      requires_name: true
    render:
      layer: "labels"
      color: [0, 0, 0, 255]
      font_size: 18
      priority: 1

  large_towns: &large_towns
    name: "large_towns"
    osm_match:
      geometry: ["Point"]
      tags:
        place: ["town"]
      requires_name: true
      population_min: 50000
    render:
      layer: "labels"
      color: [0, 0, 0, 255]
      font_size: 16
      priority: 2

  towns: &towns
    name: "towns"
    osm_match:
      geometry: ["Point"]
      tags:
        place: ["town"]
      requires_name: true
      population_max: 49999
    render:
      layer: "labels"
      color: [0, 0, 0, 255]
      font_size: 16
      priority: 3

  large_villages: &large_villages
    name: "large_villages"
    osm_match:
      geometry: ["Point"]
      tags:
        place: ["village"]
      requires_name: true
      population_min: 5000
    render:
      layer: "labels"
      color: [0, 0, 0, 255]
      font_size: 14
      priority: 4

  villages: &villages
    name: "villages"
    osm_match:
      geometry: ["Point"]
      tags:
        place: ["village"]
      requires_name: true
      population_max: 4999
    render:
      layer: "labels"
      color: [0, 0, 0, 255]
      font_size: 14
      priority: 5

  suburbs: &suburbs
    name: "suburbs"
    osm_match:
      geometry: ["Point"]
      tags:
        place: ["suburb", "borough", "quarter"]
      requires_name: true
    render:
      layer: "labels"
      color: [0, 0, 0, 255]
      font_size: 13
      priority: 6

  hamlets: &hamlets
    name: "hamlets"
    osm_match:
      geometry: ["Point"]
      tags:
        place: ["hamlet", "neighbourhood"]
      requires_name: true
    render:
      layer: "labels"
      color: [0, 0, 0, 255]
      font_size: 12
      priority: 7

  localities: &localities
    name: "localities"
    osm_match:
      geometry: ["Point"]
      tags:
        place: ["locality", "isolated_dwelling"]
      requires_name: true
    render:
      layer: "labels"
      color: [0, 0, 0, 255]
      font_size: 11
      priority: 8

  pois: &pois
    name: "pois"
    osm_match:
      geometry: ["Point"]
      tags:
        amenity: ["*"]
        shop: ["*"]
        tourism: ["*"]
        historic: ["*"]
      requires_name: true
    render:
      layer: "pois"
      color: [100, 100, 100, 255]

# =============================================================================
# TILESETS
# =============================================================================
tilesets:
  # ===========================================================================
  # T1: DETAIL (100m - 2000m) — merges old t1+t2
  # ===========================================================================
  - id: "t1"
    name: "Detail"
    view_range_meters: [100, 2000]
    tile_size_meters: 400

    features:
      # All features, very light simplification (5cm) to reduce coordinate bloat
      - <<: *coastline
        simplification: { epsilon_m: 0.05 }
      - <<: *water_bodies_all
        simplification: { epsilon_m: 0.05 }
      - <<: *major_rivers
        simplification: { epsilon_m: 0.05 }
      - <<: *minor_waterways
        simplification: { epsilon_m: 0.05 }
      - <<: *scrub_heath
        simplification: { epsilon_m: 0.05 }
      - <<: *wetland
        simplification: { epsilon_m: 0.05 }
      - <<: *beach
        simplification: { epsilon_m: 0.05 }
      - <<: *cliff
        simplification: { epsilon_m: 0.05 }
      - <<: *forests_all
        simplification: { epsilon_m: 0.05 }
      - <<: *motorways
        simplification: { epsilon_m: 0.05 }
      - <<: *primary_roads
        simplification: { epsilon_m: 0.05 }
      - <<: *secondary_roads
        simplification: { epsilon_m: 0.05 }
      - <<: *tertiary_roads
        simplification: { epsilon_m: 0.05 }
      - <<: *residential_roads
        simplification: { epsilon_m: 0.05 }
      - <<: *minor_roads
        simplification: { epsilon_m: 0.05 }
      - <<: *major_rail
        simplification: { epsilon_m: 0.05 }
      - <<: *subway_light_rail
        simplification: { epsilon_m: 0.05 }
      - <<: *tram
        simplification: { epsilon_m: 0.05 }
      - <<: *railway_platforms
        simplification: { epsilon_m: 0.05 }
      - <<: *railway_stations
        simplification: { epsilon_m: 0.05 }
      - <<: *parks
        simplification: { epsilon_m: 0.05 }
      - <<: *agriculture
        simplification: { epsilon_m: 0.05 }
      - <<: *residential_landuse
        simplification: { epsilon_m: 0.05 }
      - <<: *commercial_landuse
        simplification: { epsilon_m: 0.05 }
      - <<: *industrial_landuse
        simplification: { epsilon_m: 0.05 }
      - <<: *cemeteries
        simplification: { epsilon_m: 0.05 }
      - <<: *military
        simplification: { epsilon_m: 0.05 }
      - <<: *railway_yards
        simplification: { epsilon_m: 0.05 }
      - <<: *allotments
        simplification: { epsilon_m: 0.05 }
      - <<: *construction
        simplification: { epsilon_m: 0.05 }
      - <<: *education
        simplification: { epsilon_m: 0.05 }
      - <<: *religious
        simplification: { epsilon_m: 0.05 }
      - <<: *quarries
        simplification: { epsilon_m: 0.05 }
      - <<: *port
        simplification: { epsilon_m: 0.05 }
      - <<: *institutional
        simplification: { epsilon_m: 0.05 }
      - <<: *flowerbed
        simplification: { epsilon_m: 0.05 }
      - <<: *highway_service_areas
        simplification: { epsilon_m: 0.05 }
      - <<: *playground
        simplification: { epsilon_m: 0.05 }
      - <<: *swimming_pool
        simplification: { epsilon_m: 0.05 }
      - <<: *picnic_site
        simplification: { epsilon_m: 0.05 }
      - <<: *table_tennis
        simplification: { epsilon_m: 0.05 }
      - <<: *beach_volleyball
        simplification: { epsilon_m: 0.05 }
      - <<: *runways
        simplification: { epsilon_m: 0.05 }
      - <<: *taxiways
        simplification: { epsilon_m: 0.05 }
      - <<: *aprons
        simplification: { epsilon_m: 0.05 }
      - <<: *helipads
        simplification: { epsilon_m: 0.05 }
      - <<: *buildings
        simplification: { epsilon_m: 0.05 }
      - <<: *country_borders
        simplification: { epsilon_m: 0.05 }
      - <<: *state_borders
        simplification: { epsilon_m: 0.05 }
      - <<: *district_borders
        simplification: { epsilon_m: 0.05 }
      - <<: *cities
      - <<: *large_towns
      - <<: *towns
      - <<: *large_villages
      - <<: *villages
      - <<: *suburbs
      - <<: *hamlets
      - <<: *localities
      - <<: *pois

  # ===========================================================================
  # T2: CITY (3km - 15km) — merges old t3+t4
  # ===========================================================================
  - id: "t2"
    name: "City"
    view_range_meters: [3000, 15000]
    tile_size_meters: 2500

    features:
      # All features with moderate simplification, no area filters
      - <<: *coastline
        simplification: { epsilon_m: 3 }
      - <<: *water_bodies_all
        simplification: { epsilon_m: 3 }
      - <<: *major_rivers
        simplification: { epsilon_m: 3 }
      - <<: *minor_waterways
        simplification: { epsilon_m: 3 }
      - <<: *scrub_heath
        simplification: { epsilon_m: 3 }
      - <<: *wetland
        simplification: { epsilon_m: 3 }
      - <<: *beach
        simplification: { epsilon_m: 3 }
      - <<: *forests_all
        simplification: { epsilon_m: 3 }
      - <<: *motorways
        simplification: { epsilon_m: 3 }
      - <<: *primary_roads
        simplification: { epsilon_m: 3 }
      - <<: *secondary_roads
        simplification: { epsilon_m: 3 }
      - <<: *tertiary_roads
        simplification: { epsilon_m: 3 }
      - <<: *residential_roads
        simplification: { epsilon_m: 3 }
      # NO minor_roads
      - <<: *major_rail
        simplification: { epsilon_m: 3 }
      - <<: *subway_light_rail
        simplification: { epsilon_m: 3 }
      - <<: *tram
        simplification: { epsilon_m: 3 }
      - <<: *railway_platforms
        simplification: { epsilon_m: 3 }
      - <<: *railway_stations
        simplification: { epsilon_m: 3 }
      - <<: *parks
        simplification: { epsilon_m: 3 }
      - <<: *agriculture
        simplification: { epsilon_m: 3 }
      - <<: *residential_landuse
        simplification: { epsilon_m: 3 }
      - <<: *commercial_landuse
        simplification: { epsilon_m: 3 }
      - <<: *industrial_landuse
        simplification: { epsilon_m: 3 }
      - <<: *cemeteries
        simplification: { epsilon_m: 3 }
      - <<: *military
        simplification: { epsilon_m: 3 }
      - <<: *railway_yards
        simplification: { epsilon_m: 3 }
      - <<: *allotments
        simplification: { epsilon_m: 3 }
      - <<: *construction
        simplification: { epsilon_m: 3 }
      - <<: *education
        simplification: { epsilon_m: 3 }
      - <<: *religious
        simplification: { epsilon_m: 3 }
      - <<: *quarries
        simplification: { epsilon_m: 3 }
      - <<: *port
        simplification: { epsilon_m: 3 }
      - <<: *institutional
        simplification: { epsilon_m: 3 }
      - <<: *flowerbed
        simplification: { epsilon_m: 3 }
      - <<: *highway_service_areas
        simplification: { epsilon_m: 3 }
      - <<: *playground
        simplification: { epsilon_m: 3 }
      - <<: *swimming_pool
        simplification: { epsilon_m: 3 }
      - <<: *picnic_site
        simplification: { epsilon_m: 3 }
      - <<: *table_tennis
        simplification: { epsilon_m: 3 }
      - <<: *beach_volleyball
        simplification: { epsilon_m: 3 }
      - <<: *runways
        simplification: { epsilon_m: 3 }
      - <<: *taxiways
        simplification: { epsilon_m: 3 }
      - <<: *aprons
        simplification: { epsilon_m: 3 }
      - <<: *buildings
        simplification: { epsilon_m: 3 }
      - <<: *country_borders
        simplification: { epsilon_m: 3 }
      - <<: *state_borders
        simplification: { epsilon_m: 3 }
      - <<: *district_borders
        simplification: { epsilon_m: 3 }
      - <<: *maritime_territorial
        simplification: { epsilon_m: 3 }
      - <<: *maritime_eez
        simplification: { epsilon_m: 3 }
      - <<: *cities
      - <<: *large_towns
      - <<: *towns
      - <<: *large_villages
      - <<: *villages
      - <<: *suburbs

  # ===========================================================================
  # T3: REGION (20km - 150km) — merges old t5+t6
  # ===========================================================================
  - id: "t3"
    name: "Region"
    view_range_meters: [20000, 150000]
    tile_size_meters: 25000

    features:
      # Major features with area filters and aggressive simplification
      - <<: *coastline
        simplification: { epsilon_m: 50 }
      - name: "water_bodies_medium_large"
        osm_match:
          geometry: ["Polygon", "MultiPolygon"]
          tags:
            natural: ["water"]
            waterway: ["riverbank"]
            landuse: ["basin", "reservoir", "salt_pond"]
          min_area_km2: 0.01
        render:
          layer: "water"
          color: [170, 211, 223, 255]
          fill: true
        simplification: { epsilon_m: 50 }
      - <<: *major_rivers
        simplification: { epsilon_m: 50 }
      # NO minor_waterways
      - name: "scrub_heath_medium_large"
        osm_match:
          geometry: ["Polygon", "MultiPolygon"]
          tags:
            natural: ["scrub", "heath"]
          min_area_km2: 0.1
        render:
          layer: "natural_background"
          color: [200, 215, 175, 255]
          fill: true
        simplification: { epsilon_m: 50 }
      - name: "wetland_medium_large"
        osm_match:
          geometry: ["Polygon", "MultiPolygon"]
          tags:
            natural: ["wetland"]
          min_area_km2: 0.1
        render:
          layer: "natural_background"
          color: [200, 225, 210, 255]
          fill: true
        simplification: { epsilon_m: 50 }
      - name: "beach_medium_large"
        osm_match:
          geometry: ["Polygon", "MultiPolygon"]
          tags:
            natural: ["beach"]
          min_area_km2: 0.05
        render:
          layer: "natural_background"
          color: [255, 241, 186, 255]
          fill: true
        simplification: { epsilon_m: 50 }
      - name: "forests_medium_large"
        osm_match:
          geometry: ["Polygon", "MultiPolygon"]
          tags:
            landuse: ["forest"]
            natural: ["wood"]
          min_area_km2: 0.01
          preserve_tags: ["leaf_type"]
        render:
          layer: "forests"
          color: [173, 209, 158, 255]
          fill: true
        simplification: { epsilon_m: 50 }
      - <<: *motorways
        simplification: { epsilon_m: 50 }
      - <<: *primary_roads
        simplification: { epsilon_m: 50 }
      - <<: *secondary_roads
        simplification: { epsilon_m: 50 }
      # NO tertiary/residential/minor roads
      - <<: *major_rail
        simplification: { epsilon_m: 50 }
      - <<: *subway_light_rail
        simplification: { epsilon_m: 50 }
      # NO tram
      - <<: *railway_stations
        simplification: { epsilon_m: 50 }
      - <<: *parks
        simplification: { epsilon_m: 50 }
      - <<: *agriculture
        simplification: { epsilon_m: 50 }
      - <<: *residential_landuse
        simplification: { epsilon_m: 50 }
      - <<: *commercial_landuse
        simplification: { epsilon_m: 50 }
      - <<: *industrial_landuse
        simplification: { epsilon_m: 50 }
      - <<: *cemeteries
        simplification: { epsilon_m: 50 }
      - <<: *military
        simplification: { epsilon_m: 50 }
      - <<: *railway_yards
        simplification: { epsilon_m: 50 }
      # NO allotments/construction/education/religious/quarries/buildings
      - <<: *runways
        simplification: { epsilon_m: 50 }
      - <<: *country_borders
        simplification: { epsilon_m: 50 }
      - <<: *state_borders
        simplification: { epsilon_m: 50 }
      - <<: *maritime_territorial
        simplification: { epsilon_m: 50 }
      - <<: *maritime_eez
        simplification: { epsilon_m: 50 }
      - <<: *cities
      - <<: *large_towns
      - <<: *towns
      - <<: *large_villages

  # ===========================================================================
  # T4: OVERVIEW (200km - 1000km) — old t7
  # ===========================================================================
  - id: "t4"
    name: "Overview"
    view_range_meters: [200000, 1000000]
    tile_size_meters: 50000

    features:
      # Only large features with heavy simplification
      - <<: *coastline
        simplification: { epsilon_m: 200 }
      - name: "water_bodies_large"
        osm_match:
          geometry: ["Polygon", "MultiPolygon"]
          tags:
            natural: ["water"]
            waterway: ["riverbank"]
            landuse: ["basin", "reservoir", "salt_pond"]
          min_area_km2: 1.0
        render:
          layer: "water"
          color: [170, 211, 223, 255]
          fill: true
        simplification: { epsilon_m: 200 }
      # NO rivers
      - name: "forests_large"
        osm_match:
          geometry: ["Polygon", "MultiPolygon"]
          tags:
            landuse: ["forest"]
            natural: ["wood"]
          min_area_km2: 1.0
          preserve_tags: ["leaf_type"]
        render:
          layer: "forests"
          color: [173, 209, 158, 255]
          fill: true
        simplification: { epsilon_m: 200 }
      - <<: *motorways
        simplification: { epsilon_m: 200 }
      - <<: *primary_roads
        simplification: { epsilon_m: 200 }
      # NO secondary/tertiary/residential/minor roads
      - <<: *major_rail
        simplification: { epsilon_m: 200 }
      # NO subway/tram
      # NO landuse
      - <<: *country_borders
        simplification: { epsilon_m: 200 }
      - <<: *maritime_territorial
        simplification: { epsilon_m: 200 }
      - <<: *maritime_eez
        simplification: { epsilon_m: 200 }
      - <<: *cities
      - <<: *large_towns

# =============================================================================
# LAYER RENDERING ORDER (bottom to top)
# =============================================================================
layer_order:
  - landuse
  - water
  - forests
  - buildings
  - boundaries
  - coastline
  - railways
  - major_roads
  - roads
  - waterways
  - labels
  - pois
