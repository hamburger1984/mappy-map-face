# OSM Renderer Configuration
# Based on CURRENT actual behavior (as-is analysis)

# =============================================================================
# CURRENT RENDERING GROUPS
# =============================================================================
# Groups view widths that currently render the SAME features with SAME tiles
# Based on actual LOD thresholds and tile zoom thresholds

rendering_groups:
  # Group 1: LOD 4, Tile Z14
  - view_widths_meters: [100, 150, 200, 300, 500, 700, 1000]
    lod: 4
    tile_zoom: 14
    description: "Very zoomed in - all details including POIs"

  # Group 2: LOD 3, Tile Z11
  - view_widths_meters: [1500, 2000]
    lod: 3
    tile_zoom: 11
    description: "More zoomed in - buildings and more roads"

  # Group 3: LOD 2, Tile Z11
  - view_widths_meters: [3000, 5000, 7000]
    lod: 2
    tile_zoom: 11
    description: "Zoomed in - most features"

  # Group 4: LOD 1, Tile Z11
  - view_widths_meters: [10000, 15000]
    lod: 1
    tile_zoom: 11
    description: "Medium zoom - major + secondary features"

  # Group 5: LOD 1, Tile Z8
  - view_widths_meters: [20000, 30000, 50000, 70000]
    lod: 1
    tile_zoom: 8
    description: "Medium zoom - major + secondary features"

  # Group 6: LOD 0, Tile Z5
  - view_widths_meters: [100000, 150000]
    lod: 0
    tile_zoom: 5
    description: "Very zoomed out - major features only"

  # Group 7: LOD 0, Tile Z3
  - view_widths_meters: [200000]
    lod: 0
    tile_zoom: 3
    description: "Very zoomed out - major features only"

# =============================================================================
# ACTUAL LOD THRESHOLDS (from map_renderer.js getLOD())
# =============================================================================
lod_thresholds:
  lod_4: { max_view_width: 1000 } # < 1km
  lod_3: { max_view_width: 3000 } # 1-3km
  lod_2: { max_view_width: 7500 } # 3-7.5km
  lod_1: { max_view_width: 20000 } # 7.5-20km
  lod_0: { max_view_width: Infinity } # > 20km

# =============================================================================
# ACTUAL TILE ZOOM THRESHOLDS (from map_renderer.js getZoomLevelForScale())
# =============================================================================
tile_zoom_thresholds:
  z14: { max_view_width: 2000 } # < 2km
  z11: { max_view_width: 15000 } # 2-15km
  z8: { max_view_width: 100000 } # 15-100km
  z5: { max_view_width: 500000 } # 100-500km
  z3: { max_view_width: Infinity } # >= 500km

# =============================================================================
# FEATURE DEFINITIONS (from step_3_generate_tiles.py and map_renderer.js)
# =============================================================================

features:
  # ===========================================================================
  # WATER
  # ===========================================================================

  - name: "coastline"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      natural: ["coastline"]
    render:
      layer: "coastline"
      color: [255, 0, 255, 255]
      stroke_width_px: 3
      show_direction: true
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]
    current_simplification:
      z3: { epsilon_deg: 0.0009 } # 0.003 * 0.3
      z5: { epsilon_deg: 0.0006 } # 0.002 * 0.3
      z8: { epsilon_deg: 0.00024 } # 0.0008 * 0.3
      z11: { epsilon_deg: 0.00006 } # 0.0002 * 0.3
      z14: { disabled: true }

  - name: "water_bodies"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      natural: ["water"]
      waterway: ["riverbank"]
      landuse: ["basin", "reservoir", "salt_pond"]
    render:
      layer: "water_areas"
      color: [170, 211, 223, 255]
      fill: true
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]
    size_adjustment: "YES - planned but NOT in current tiles"
    current_simplification:
      z3: { epsilon_deg: 0.003 }
      z5: { epsilon_deg: 0.002 }
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "major_rivers"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      waterway: ["river", "canal"]
    render:
      layer: "waterways"
      color: [170, 211, 223, 255]
      use_width_tag: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "minor_waterways"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      waterway: ["stream", "ditch", "drain"]
    render:
      layer: "waterways"
      color: [170, 211, 223, 255]
      use_width_tag: true
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  # ===========================================================================
  # FORESTS
  # ===========================================================================

  - name: "forests"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["forest"]
      natural: ["wood"]
    render:
      layer: "forests"
      color: [173, 209, 158, 255]
      fill: true
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]
    size_adjustment: "YES - planned but NOT in current tiles"
    current_simplification:
      z3: { epsilon_deg: 0.003 }
      z5: { epsilon_deg: 0.002 }
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  # ===========================================================================
  # ROADS
  # ===========================================================================

  - name: "motorways_trunk"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      highway: ["motorway", "trunk", "motorway_link", "trunk_link"]
    render:
      layer: "major_roads"
      color: [233, 115, 103, 255]
      use_width_tag: true
      name_priority: 1
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]
    current_simplification:
      z3: { epsilon_deg: 0.0012 } # 0.003 * 0.4
      z5: { epsilon_deg: 0.0008 } # 0.002 * 0.4
      z8: { epsilon_deg: 0.00032 } # 0.0008 * 0.4
      z11: { epsilon_deg: 0.00008 } # 0.0002 * 0.4
      z14: { disabled: true }

  - name: "primary_roads"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      highway: ["primary", "primary_link"]
    render:
      layer: "major_roads"
      color: [252, 214, 164, 255]
      use_width_tag: true
      name_priority: 2
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]
    current_simplification:
      z3: { epsilon_deg: 0.0012 }
      z5: { epsilon_deg: 0.0008 }
      z8: { epsilon_deg: 0.00032 }
      z11: { epsilon_deg: 0.00008 }
      z14: { disabled: true }

  - name: "secondary_roads"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      highway: ["secondary", "secondary_link"]
    render:
      layer: "major_roads"
      color: [252, 214, 164, 255]
      use_width_tag: true
      name_priority: 3
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.00032 }
      z11: { epsilon_deg: 0.00008 }
      z14: { disabled: true }

  - name: "tertiary_roads"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      highway: ["tertiary", "tertiary_link"]
    render:
      layer: "roads"
      color: [255, 255, 255, 255]
      use_width_tag: true
      name_priority: 4
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.00008 }
      z14: { disabled: true }

  - name: "residential_roads"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      highway: ["residential", "unclassified", "living_street"]
    render:
      layer: "roads"
      color: [255, 255, 255, 255]
      use_width_tag: true
      name_priority: 5
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.00008 }
      z14: { disabled: true }

  - name: "minor_roads"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      highway:
        [
          "service",
          "track",
          "path",
          "footway",
          "cycleway",
          "bridleway",
          "pedestrian",
          "steps",
        ]
    render:
      layer: "roads"
      color: [220, 220, 220, 255]
      use_width_tag: true
      name_priority: 6
    current_min_lod: 3
    current_tiles: [14]
    current_simplification:
      z14: { disabled: true }

  # ===========================================================================
  # RAILWAYS
  # ===========================================================================

  - name: "major_rail"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      railway: ["rail", "narrow_gauge", "preserved"]
    render:
      layer: "railways"
      color: [153, 153, 153, 255]
      stroke_width_px: 2
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]
    current_simplification:
      z3: { epsilon_deg: 0.003 }
      z5: { epsilon_deg: 0.002 }
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "subway_light_rail"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      railway: ["subway", "light_rail"]
    render:
      layer: "railways"
      color: [153, 153, 153, 255]
      stroke_width_px: 2
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "tram"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      railway: ["tram", "funicular", "miniature"]
    render:
      layer: "railways"
      color: [153, 153, 153, 255]
      stroke_width_px: 1
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  # ===========================================================================
  # LANDUSE
  # ===========================================================================

  - name: "parks"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      leisure: ["park", "garden", "recreation_ground", "dog_park", "playground"]
      landuse: ["grass", "meadow", "village_green", "recreation_ground"]
    render:
      layer: "natural_background"
      color: [200, 230, 180, 255]
      fill: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "agriculture"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse:
        [
          "farmland",
          "farmyard",
          "orchard",
          "vineyard",
          "plant_nursery",
          "greenhouse_horticulture",
        ]
    render:
      layer: "natural_background"
      color: [238, 240, 213, 255]
      fill: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "residential_landuse"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["residential"]
    render:
      layer: "landuse_areas"
      color: [224, 224, 224, 255]
      fill: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "commercial_landuse"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["commercial", "retail"]
    render:
      layer: "landuse_areas"
      color: [243, 233, 234, 255]
      fill: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "industrial_landuse"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["industrial"]
    render:
      layer: "landuse_areas"
      color: [240, 233, 240, 255]
      fill: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "cemeteries"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["cemetery"]
      amenity: ["grave_yard"]
    render:
      layer: "landuse_areas"
      color: [205, 220, 200, 255]
      fill: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "military"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["military"]
      military: ["*"]
    render:
      layer: "landuse_areas"
      color: [235, 215, 215, 255]
      fill: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "railway_yards"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["railway"]
    render:
      layer: "landuse_areas"
      color: [210, 205, 210, 255]
      fill: true
    current_min_lod: 1
    current_tiles: [8, 11, 14]
    current_simplification:
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "allotments"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["allotments"]
    render:
      layer: "landuse_areas"
      color: [220, 235, 210, 255]
      fill: true
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "construction"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["construction", "brownfield", "greenfield"]
    render:
      layer: "landuse_areas"
      color: [235, 220, 200, 255]
      fill: true
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "education"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["education"]
      amenity: ["school", "university", "college"]
    render:
      layer: "landuse_areas"
      color: [245, 235, 210, 255]
      fill: true
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "religious"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["religious"]
      amenity: ["place_of_worship"]
    render:
      layer: "landuse_areas"
      color: [225, 220, 230, 255]
      fill: true
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  - name: "quarries"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      landuse: ["quarry", "landfill"]
    render:
      layer: "landuse_areas"
      color: [210, 200, 190, 255]
      fill: true
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  # ===========================================================================
  # BUILDINGS
  # ===========================================================================

  - name: "buildings"
    osm_tags:
      geometry: ["Polygon", "MultiPolygon"]
      building: ["*"]
      building_exclude: ["no"]
    render:
      layer: "areas"
      color: [218, 208, 200, 255]
      fill: true
    current_min_lod: 2
    current_tiles: [11, 14]
    current_simplification:
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  # ===========================================================================
  # BOUNDARIES
  # ===========================================================================

  - name: "country_borders"
    osm_tags:
      geometry: ["LineString", "MultiLineString"]
      boundary: ["administrative"]
      admin_level: ["2"]
    render:
      layer: "boundaries"
      color: [128, 128, 128, 255]
      stroke_width_px: 2
      dash_pattern: [5, 5]
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]
    current_simplification:
      z3: { epsilon_deg: 0.003 }
      z5: { epsilon_deg: 0.002 }
      z8: { epsilon_deg: 0.0008 }
      z11: { epsilon_deg: 0.0002 }
      z14: { epsilon_deg: 0.00005 }

  # ===========================================================================
  # PLACE LABELS
  # ===========================================================================

  - name: "cities"
    osm_tags:
      geometry: ["Point"]
      place: ["city"]
      requires_name: true
    render:
      layer: "place_labels"
      color: [0, 0, 0, 255]
      font_size: 18
      priority: 1
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]

  - name: "large_towns"
    osm_tags:
      geometry: ["Point"]
      place: ["town"]
      requires_name: true
      population_min: 50000
    render:
      layer: "place_labels"
      color: [0, 0, 0, 255]
      font_size: 16
      priority: 2
    current_min_lod: 0
    current_tiles: [3, 5, 8, 11, 14]

  - name: "towns"
    osm_tags:
      geometry: ["Point"]
      place: ["town"]
      requires_name: true
      population_max: 49999
    render:
      layer: "place_labels"
      color: [0, 0, 0, 255]
      font_size: 16
      priority: 3
    current_min_lod: 1
    current_tiles: [8, 11, 14]

  - name: "large_villages"
    osm_tags:
      geometry: ["Point"]
      place: ["village"]
      requires_name: true
      population_min: 5000
    render:
      layer: "place_labels"
      color: [0, 0, 0, 255]
      font_size: 14
      priority: 4
    current_min_lod: 1
    current_tiles: [8, 11, 14]

  - name: "villages"
    osm_tags:
      geometry: ["Point"]
      place: ["village"]
      requires_name: true
      population_max: 4999
    render:
      layer: "place_labels"
      color: [0, 0, 0, 255]
      font_size: 14
      priority: 5
    current_min_lod: 2
    current_tiles: [11, 14]

  - name: "suburbs"
    osm_tags:
      geometry: ["Point"]
      place: ["suburb", "borough", "quarter"]
      requires_name: true
    render:
      layer: "place_labels"
      color: [0, 0, 0, 255]
      font_size: 13
      priority: 6
    current_min_lod: 2
    current_tiles: [11, 14]

  - name: "hamlets"
    osm_tags:
      geometry: ["Point"]
      place: ["hamlet", "neighbourhood"]
      requires_name: true
    render:
      layer: "place_labels"
      color: [0, 0, 0, 255]
      font_size: 12
      priority: 7
    current_min_lod: 3
    current_tiles: [14]

  - name: "localities"
    osm_tags:
      geometry: ["Point"]
      place: ["locality", "isolated_dwelling"]
      requires_name: true
    render:
      layer: "place_labels"
      color: [0, 0, 0, 255]
      font_size: 11
      priority: 8
    current_min_lod: 4
    current_tiles: [14]

  # ===========================================================================
  # POIs
  # ===========================================================================

  - name: "pois"
    osm_tags:
      geometry: ["Point"]
      amenity: ["*"]
      shop: ["*"]
      tourism: ["*"]
      historic: ["*"]
      leisure: ["*"]
      requires_name: true
    render:
      layer: "poi_markers"
      icon_size_px: 8
    current_min_lod: 4
    current_tiles: [14]

# =============================================================================
# LAYER RENDERING ORDER (bottom to top)
# =============================================================================
layer_order:
  - natural_background
  - water_areas
  - forests
  - landuse_areas
  - areas
  - boundaries
  - coastline
  - railways
  - major_roads
  - roads
  - waterways
  - place_labels
  - poi_markers
